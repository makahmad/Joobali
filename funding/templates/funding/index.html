<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Theme Company</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ STATIC_URL }}funding/style.css" />
  <link rel="stylesheet" href="{{ STATIC_URL }}funding/nav-wizard.bootstrap.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.min.css" />

  <script src="https://cdn.dwolla.com/1/dwolla.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js">
  </script>
  <script src="https://cdn.jsdelivr.net/bootstrap.timepicker/0.2.6/js/bootstrap-timepicker.min.js"></script>
  <script src="{{ STATIC_URL }}funding/funding_app.js"></script>

</head>

<body id="myPage" ng-app="fundingApp" ng-controller="FundingCtrl">


<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span> 
      </button>
      <img src="{{ STATIC_URL }}logo/logo-1.jpg" alt="Logo" width="100" height="50">
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#about">ABOUT</a></li>
        <li><a href="#services">PROGRAMS</a></li>
        <li><a href="#contact">CONTACT</a></li>
      </ul>
    </div>
  </div>
</nav>

{% verbatim %}
<div class="fundingTable">
  <div class="fundingList">
    <h2>Your Funding Sources:</h2> 
    <table class="table">
      <thead>
        <th>Bank Name</th>
        <th>Account Type</th>
        <th>Status</th>
      </thead>
      <tbody>
        <tr data-ng-repeat="funding in fundings track by $index">
          <td>{{ funding.name }}</td>
          <td>{{ funding.type }}</td>
          <td>{{ funding.status }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="fundingTableButtonDiv">
    <button class="fundingTableButton btn btn-primary btn-lg" data-toggle="modal" data-target="#addFundingModal">Add Funding</button>
    <button class="makeTransferButton btn btn-primary btn-lg" data-toggle="modal" data-target="#makeTransferModal">Make Transfer</button>
    <button class="fundingTableButton btn btn-primary btn-lg" data-toggle="modal" data-target="#iavModal" ng-disabled="!iavToken" ng-click="handleIAV()">Add Funding (IAV)</button>
  </div>
</div>
{% endverbatim %} 




<!-- Modal -->
<div id="addFundingModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add a New Funding Source:</h4>
      </div>
      <div class="modal-body">
          <div class="col-centered fundingOverviewForm">
            <form id="fundingForm" role="form" class="form-horizontal well" action="/funding/" method="POST">
              {% csrf_token %}
              <div id="step1" class="form-content active">
                <div class="form-group">
                  <label class="control-label col-sm-2" for="name">Bank Name:</label>

                  <div class="col-sm-10"> 
                    <input type="text" class="form-control" id="name" name="name" required="true" value="{{ form.name.data|safe }}">
                  </div>
                </div>
                  {% if form.name.errors %}
                      <div class="form-group">
                      <span class="label label-warning col-sm-offset-2">Bank already registered...</span>
                    </div>
                  {% endif %}
                <div class="form-group">
                  <label class="control-label col-sm-2" for="type">Account Type:</label>

                  <div class="col-sm-10">
                    <label class="radio-inline"><input type="radio" name="type" value="savings" checked>Savings</label>
                    <label class="radio-inline"><input type="radio" name="type" value="checking">Checking</label>
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-sm-2" for="accountNumber">Account Number:</label>
                  
                  <div class="col-sm-10">
                    <input type="text" pattern="[0-9]{9}" class="form-control" id="accountNumber" name="accountNumber" required="true" value="{{ form.accountNumber.data|safe }}">
                  </div>
                </div>

                  {% if form.accountNumber.errors %}
                      <div class="form-group">
                      <span class="label label-warning col-sm-offset-2">Invalid Account Number</span>
                    </div>
                  {% endif %}
                <div class="form-group">
                  <label class="control-label col-sm-2" for="routingNumber">Routing Number:</label>
                  
                  <div class="col-sm-10">
                    <input type="text" pattern="[0-9]{9}" class="form-control" id="routingNumber" name="routingNumber" required="true" value="{{ form.routingNumber.data|safe }}">
                  </div>
                </div>
                  {% if form.routingNumber.errors %}
                      <div class="form-group">
                      <span class="label label-warning col-sm-offset-2">Invalid Routing Number</span>
                    </div>
                  {% endif %}
              </div>
            </form>
          </div>
      </div>
      <div class="modal-footer">
        <button id="saveButton" type="button" class="btn btn-primary" onclick="handleSave()">Save</button>
      </div>
    </div>

  </div>
</div>

<!-- Modal -->
<div id="makeTransferModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Make a Transfer:</h4>
      </div>
      <div class="modal-body">
          <div class="col-centered makeTransferForm">
            <form id="transferForm" role="form" class="form-horizontal well" action="/funding/" method="POST">
              {% csrf_token %}
                <div class="form-group">
                  <label class="control-label col-sm-2" for="name">From:</label>

                  <div class="col-sm-10">
                    <select class="form-control" id="source" name="source" required="true">
                      {% verbatim %}
                      <option ng-repeat="funding in fundings track by $index" value="{{funding.id}}">
                        {{ funding.name }}
                      </option>
                      {% endverbatim %} 
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label class="control-label col-sm-2" for="name">To:</label>

                  <div class="col-sm-10">
                    <select class="form-control" id="destination" name="destination" required="true">
                      {% verbatim %}
                      <option ng-repeat="provider in providers track by $index" value="{{provider.id}}">
                        {{ provider.firstName }} {{ provider.lastName }}
                      </option>
                      {% endverbatim %} 
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label class="control-label col-sm-2" for="amount">Amount:</label>
                  
                  <div class="col-sm-10">
                    <input type="text" pattern="[0-9]+(\\.[0-9][0-9]?)?" class="form-control" id="amount" name="amount" required="true">
                  </div>
                </div>
            </form>
          </div>
      </div>
      <div class="modal-footer">
        <button id="sendButton" type="button" class="btn btn-primary" ng-click="makeTransfer()">Send</button>
      </div>
    </div>

  </div>
</div>


<!-- Modal -->
<div id="iavModal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Add verified funding source:</h4>
      </div>
      <div class="modal-body">
          
        <!-- IAV verification flow container -->
        <div id="iavContainer"></div>
        <!-- END: IAV verification flow container -->
      </div>
    </div>
  </div>
</div>


<div class="container-fluid">
  <div class="row">
    <div class="col-sm-6 text-center">
      <img class="logo" src="{{ STATIC_URL }}logo/logo-2.jpg" alt="Logo">
    </div>
    <div class="col-sm-6">
      <h2>About Joobali</h2>
      <h4>We provides services for both parents and childcare providers.</h4> 
      <button class="btn btn-default btn-lg">Get in Touch</button>
    </div>
  </div>
</div>

<footer class="container-fluid text-center">
  <a href="#myPage" title="To Top">
    <span class="glyphicon glyphicon-chevron-up"></span>
  </a>
  <p>Joobali Inc. 2016 <a href="http://joobali-1310.appspot.com" title="Joobali">www.joobali.com</a></p> 
</footer>

<script>

$(document).ready(function(){

    $('[data-toggle="tooltip"]').tooltip(); 
});


var handleSave = function() {
  console.log($(".form-content.active"));
  var curContent = $(".form-content.active");

  var curInputs = curContent.find("input"),
  isValid = true;

      $(".form-group").removeClass("has-error");
      for(var i=0; i< curInputs.length; i++){
          if (!curInputs[i].validity.valid){
              isValid = false;
              $(curInputs[i]).closest(".form-group").addClass("has-error");
          }
      }
      console.log(isValid);
  if (isValid) {
    $("#fundingForm").submit();
  }
};


var handleSend = function() {
  var curContent = $("#transferForm");

  var curInputs = curContent.find("input"),
  isValid = true;

      $(".form-group").removeClass("has-error");
      for(var i=0; i< curInputs.length; i++){
          if (!curInputs[i].validity.valid){
              isValid = false;
              $(curInputs[i]).closest(".form-group").addClass("has-error");
          }
      }
      console.log(isValid);
  if (isValid) {
    console.log($('#source :selected').val());
    console.log($('#destination :selected').val());
    console.log($('#amount').val());
  }
};


</script>
</body>

</html>